// Trusted domains // TODO: remove this. Instead, show warning and let user choose to trust the domain.

// Only include top-level + 2nd-level domains (exclude subdomains). E.g.
// www.google.com -> google.com
// docs.google.com -> google.com
// www.standard.co.uk -> standard.co.uk
const trustedDomains = new Map<string, boolean>([
    ['123rf.com', true],
    ['20minutos.es', true],
    ['4chan.org', true],
    ['4channel.org', true],
    ['4shared.com', true],
    ['a8.net', true],
    ['abc.es', true],
    ['abc.net.au', true],
    ['abcnews.go.com', true],
    ['about.com', true],
    ['aboutads.info', true],
    ['abril.com.br', true],
    ['academia.edu', true],
    ['addthis.com', true],
    ['addtoany.com', true],
    ['adobe.com', true],
    ['afternic.com', true],
    ['airbnb.com', true],
    ['akamaihd.net', true],
    ['akamaized.net', true],
    ['alexa.com', true],
    ['alicdn.com', true],
    ['aliexpress.com', true],
    ['allaboutcookies.org', true],
    ['amazon.ca', true],
    ['amazon.co.jp', true],
    ['amazon.co.uk', true],
    ['amazon.com', true],
    ['amazon.de', true],
    ['amazon.es', true],
    ['amazon.fr', true],
    ['amazon.in', true],
    ['amazon.it', true],
    ['ameblo.jp', true],
    ['amzn.to', true],
    ['android.com', true],
    ['aol.com', true],
    ['apache.org', true],
    ['apple.com', true],
    ['archive.org', true],
    ['archives.gov', true],
    ['arxiv.org', true],
    ['asahi.com', true],
    ['asus.com', true],
    ['bandcamp.com', true],
    ['barnesandnoble.com', true],
    ['bbc.co.uk', true],
    ['bbc.com', true],
    ['bbci.co.uk', true],
    ['berkeley.edu', true],
    ['bfmtv.com', true],
    ['bigcommerce.com', true],
    ['biglobe.ne.jp', true],
    ['bing.com', true],
    ['blackberry.com', true],
    ['blog.fc2.com', true],
    ['blogger.com', true],
    ['bloglovin.com', true],
    ['blogspot.com', true],
    ['bloomberg.com', true],
    ['booking.com', true],
    ['box.com', true],
    ['brandbucket.com', true],
    ['brave.com', true],
    ['britannica.com', true],
    ['businessinsider.com', true],
    ['businesswire.com', true],
    ['buydomains.com', true],
    ['buzzfeed.com', true],
    ['ca.gov', true],
    ['cambridge.org', true],
    ['canada.ca', true],
    ['canalblog.com', true],
    ['cbc.ca', true],
    ['cbslocal.com', true],
    ['cbsnews.com', true],
    ['cdc.gov', true],
    ['change.org', true],
    ['channel4.com', true],
    ['clarin.com', true],
    ['clickbank.net', true],
    ['cloudflare.com', true],
    ['cnbc.com', true],
    ['cnet.com', true],
    ['cnn.com', true],
    ['cointernet.com.co', true],
    ['cornell.edu', true],
    ['corriere.it', true],
    ['cpanel.com', true],
    ['cpanel.net', true],
    ['craigslist.org', true],
    ['creativecommons.org', true],
    ['cutt.ly', true],
    ['dailymail.co.uk', true],
    ['dailymotion.com', true],
    ['dailystar.co.uk', true],
    ['dan.com', true],
    ['debian.org', true],
    ['deezer.com', true],
    ['dell.com', true],
    ['deloitte.com', true],
    ['detik.com', true],
    ['discord.com', true],
    ['discord.gg', true],
    ['disney.com', true],
    ['disqus.com', true],
    ['doi.org', true],
    ['domainmarket.com', true],
    ['doubleclick.net', true],
    ['dreamstime.com', true],
    ['dropbox.com', true],
    ['duckduckgo.com', true],
    ['dw.com', true],
    ['e-monsite.com', true],
    ['ea.com', true],
    ['ebay.com', true],
    ['economist.com', true],
    ['elmundo.es', true],
    ['elpais.com', true],
    ['engadget.com', true],
    ['epa.gov', true],
    ['espn.com', true],
    ['espn.go.com', true],
    ['estadao.com.br', true],
    ['etsy.com', true],
    ['europa.eu', true],
    ['eventbrite.com', true],
    ['excite.co.jp', true],
    ['express.co.uk', true],
    ['facebook.com', true],
    ['fandom.com', true],
    ['fastcompany.com', true],
    ['fb.com', true],
    ['fb.me', true],
    ['fbsbx.com', true],
    ['feedburner.com', true],
    ['fifa.com', true],
    ['files.wordpress.com', true],
    ['finance.yahoo.com', true],
    ['focus.de', true],
    ['forbes.com', true],
    ['forms.gle', true],
    ['fortune.com', true],
    ['foxnews.com', true],
    ['francetvinfo.fr', true],
    ['freepik.com', true],
    ['frontiersin.org', true],
    ['ft.com', true],
    ['ftc.gov', true],
    ['fudthepug.com', true],
    ['garanteprivacy.it', true],
    ['geocities.com', true],
    ['getbootstrap.com', true],
    ['ggpht.com', true],
    ['giphy.com', true],
    ['github.com', true],
    ['github.io', true],
    ['gizmodo.com', true],
    ['globo.com', true],
    ['gmail.com', true],
    ['gnu.org', true],
    ['godaddy.com', true],
    ['gofundme.com', true],
    ['goodreads.com', true],
    ['google.ca', true],
    ['google.co.id', true],
    ['google.co.in', true],
    ['google.co.jp', true],
    ['google.co.uk', true],
    ['google.com', true],
    ['google.com.br', true],
    ['google.de', true],
    ['google.es', true],
    ['google.fr', true],
    ['google.it', true],
    ['google.nl', true],
    ['google.pl', true],
    ['google.ru', true],
    ['googleapis.com', true],
    ['googleblog.com', true],
    ['googleusercontent.com', true],
    ['gooyaabitemplates.com', true],
    ['gotbeef.app', true],
    ['gravatar.com', true],
    ['gstatic.com', true],
    ['guardian.co.uk', true],
    ['harvard.edu', true],
    ['hatena.ne.jp', true],
    ['hindustantimes.com', true],
    ['house.gov', true],
    ['hp.com', true],
    ['huawei.com', true],
    ['hubspot.com', true],
    ['huffingtonpost.com', true],
    ['huffpost.com', true],
    ['hugedomains.com', true],
    ['ibm.com', true],
    ['icann.org', true],
    ['ietf.org', true],
    ['ig.com.br', true],
    ['ign.com', true],
    ['ikea.com', true],
    ['imageshack.com', true],
    ['imageshack.us', true],
    ['imdb.com', true],
    ['imgur.com', true],
    ['inc.com', true],
    ['indeed.com', true],
    ['independent.co.uk', true],
    ['indianexpress.com', true],
    ['indiatimes.com', true],
    ['insider.com', true],
    ['instagram.com', true],
    ['instructables.com', true],
    ['intel.com', true],
    ['issuu.com', true],
    ['istockphoto.com', true],
    ['itmedia.co.jp', true],
    ['java.com', true],
    ['jimdofree.com', true],
    ['jstor.org', true],
    ['kickstarter.com', true],
    ['kompas.com', true],
    ['kotaku.com', true],
    ['latimes.com', true],
    ['lavanguardia.com', true],
    ['lefigaro.fr', true],
    ['lemonde.fr', true],
    ['leparisien.fr', true],
    ['lexpress.fr', true],
    ['lg.com', true],
    ['liberation.fr', true],
    ['line.me', true],
    ['linkedin.com', true],
    ['linktr.ee', true],
    ['list-manage.com', true],
    ['live.com', true],
    ['liveinternet.ru', true],
    ['lycos.com', true],
    ['m.me', true],
    ['mail.ru', true],
    ['mailchimp.com', true],
    ['marketwatch.com', true],
    ['mashable.com', true],
    ['mediafire.com', true],
    ['medium.com', true],
    ['mega.nz', true],
    ['megaupload.com', true],
    ['merriam-webster.com', true],
    ['metro.co.uk', true],
    ['microsoft.com', true],
    ['mirror.co.uk', true],
    ['mit.edu', true],
    ['mountsogol.com', true],
    ['mozilla.com', true],
    ['mozilla.org', true],
    ['msn.com', true],
    ['myshopify.com', true],
    ['myspace.com', true],
    ['mysql.com', true],
    ['mystenlabs.com', true],
    ['namecheap.com', true],
    ['narod.ru', true],
    ['nasa.gov', true],
    ['nationalgeographic.com', true],
    ['nature.com', true],
    ['naver.com', true],
    ['nbcnews.com', true],
    ['netflix.com', true],
    ['netlify.app', true],
    ['netvibes.com', true],
    ['networkadvertising.org', true],
    ['newsweek.com', true],
    ['newyorker.com', true],
    ['nginx.com', true],
    ['nginx.org', true],
    ['nih.gov', true],
    ['nikkei.com', true],
    ['noaa.gov', true],
    ['npr.org', true],
    ['nydailynews.com', true],
    ['nypost.com', true],
    ['nytimes.com', true],
    ['oecd.org', true],
    ['office.com', true],
    ['offset.com', true],
    ['ok.ru', true],
    ['okta.com', true],
    ['onamae.com', true],
    ['onlyfans.com', true],
    ['opera.com', true],
    ['oracle.com', true],
    ['orange.fr', true],
    ['ouest-france.fr', true],
    ['oup.com', true],
    ['outlook.com', true],
    ['ovh.co.uk', true],
    ['ovh.com', true],
    ['ox.ac.uk', true],
    ['pages.dev', true],
    ['parallels.com', true],
    ['patreon.com', true],
    ['paypal.com', true],
    ['pbs.org', true],
    ['pcmag.com', true],
    ['pexels.com', true],
    ['photobucket.com', true],
    ['php.net', true],
    ['pinterest.ca', true],
    ['pinterest.com', true],
    ['pinterest.fr', true],
    ['pixabay.com', true],
    ['planalto.gov.br', true],
    ['playstation.com', true],
    ['plesk.com', true],
    ['plos.org', true],
    ['pnas.org', true],
    ['politico.com', true],
    ['polymedia.app', true],
    ['prezi.com', true],
    ['privacyshield.gov', true],
    ['prnewswire.com', true],
    ['psychologytoday.com', true],
    ['python.org', true],
    ['qq.com', true],
    ['quora.com', true],
    ['radiofrance.fr', true],
    ['rakuten.co.jp', true],
    ['rambler.ru', true],
    ['rapidshare.com', true],
    ['rbc.ru', true],
    ['redbull.com', true],
    ['redd.it', true],
    ['reddit.com', true],
    ['reg.ru', true],
    ['researchgate.net', true],
    ['reuters.com', true],
    ['reverbnation.com', true],
    ['ria.ru', true],
    ['rollingstone.com', true],
    ['rottentomatoes.com', true],
    ['rt.com', true],
    ['rtve.es', true],
    ['sakura.ne.jp', true],
    ['samsung.com', true],
    ['sapo.pt', true],
    ['scholastic.com', true],
    ['sci-hub.se', true],
    ['sciencedaily.com', true],
    ['sciencedirect.com', true],
    ['sciencemag.org', true],
    ['scribd.com', true],
    ['secureserver.net', true],
    ['sedo.com', true],
    ['sendspace.com', true],
    ['sfgate.com', true],
    ['shopify.com', true],
    ['shutterstock.com', true],
    ['sina.com.cn', true],
    ['sky.com', true],
    ['skype.com', true],
    ['slate.com', true],
    ['slideshare.net', true],
    ['so-net.ne.jp', true],
    ['soundcloud.com', true],
    ['spiegel.de', true],
    ['spotify.com', true],
    ['springer.com', true],
    ['sputniknews.com', true],
    ['ssl-images-amazon.com', true],
    ['stackoverflow.com', true],
    ['standard.co.uk', true],
    ['stanford.edu', true],
    ['statista.com', true],
    ['steamcommunity.com', true],
    ['steampowered.com', true],
    ['stuff.co.nz', true],
    ['sui.io', true],
    ['suia.io', true],
    ['suifoundation.org', true],
    ['suifrens.com', true],
    ['surveymonkey.com', true],
    ['t.co', true],
    ['t.me', true],
    ['target.com', true],
    ['techcrunch.com', true],
    ['techradar.com', true],
    ['ted.com', true],
    ['telegra.ph', true],
    ['telegram.me', true],
    ['telegraph.co.uk', true],
    ['tenor.com', true],
    ['terra.com.br', true],
    ['theatlantic.com', true],
    ['theconversation.com', true],
    ['thefreedictionary.com', true],
    ['theglobeandmail.com', true],
    ['theguardian.com', true],
    ['thehill.com', true],
    ['themeforest.net', true],
    ['thenai.org', true],
    ['thesun.co.uk', true],
    ['thetimes.co.uk', true],
    ['theverge.com', true],
    ['tiktok.com', true],
    ['time.com', true],
    ['timeweb.ru', true],
    ['tinypic.com', true],
    ['tradingview.com', true],
    ['tripadvisor.com', true],
    ['tumblr.com', true],
    ['twimg.com', true],
    ['twitch.tv', true],
    ['twitter.com', true],
    ['ubuntu.com', true],
    ['un.org', true],
    ['unam.mx', true],
    ['unesco.org', true],
    ['unsplash.com', true],
    ['uol.com.br', true],
    ['urbandictionary.com', true],
    ['usatoday.com', true],
    ['usda.gov', true],
    ['usgs.gov', true],
    ['utexas.edu', true],
    ['variety.com', true],
    ['vice.com', true],
    ['viglink.com', true],
    ['vimeo.com', true],
    ['vk.com', true],
    ['vkontakte.ru', true],
    ['vox.com', true],
    ['w3.org', true],
    ['wa.me', true],
    ['walmart.com', true],
    ['washington.edu', true],
    ['washingtonpost.com', true],
    ['webcasa.app', true],
    ['webmd.com', true],
    ['webnode.page', true],
    ['weforum.org', true],
    ['weibo.com', true],
    ['whatsapp.com', true],
    ['whitehouse.gov', true],
    ['who.int', true],
    ['wikia.com', true],
    ['wikihow.com', true],
    ['wikimedia.org', true],
    ['wikipedia.org', true],
    ['wiktionary.org', true],
    ['wiley.com', true],
    ['windows.net', true],
    ['wired.com', true],
    ['wisc.edu', true],
    ['woocommerce.com', true],
    ['wordpress.com', true],
    ['wordpress.org', true],
    ['wordreference.com', true],
    ['worldbank.org', true],
    ['wp.com', true],
    ['wsj.com', true],
    ['xbox.com', true],
    ['xing.com', true],
    ['xinhuanet.com', true],
    ['yadi.sk', true],
    ['yahoo.co.jp', true],
    ['yahoo.com', true],
    ['yandex.com', true],
    ['yandex.ru', true],
    ['ycombinator.com', true],
    ['yelp.com', true],
    ['youtu.be', true],
    ['youtube.com', true],
    ['ytimg.com', true],
    ['zendesk.com', true],
    ['ziddu.com', true],
    ['zoom.us', true],
]);

export function isTrustedDomain(fullUrl: string): boolean {
    try {
        const url = new URL(fullUrl);
        if (!url) return false;
        const hostParts = url.hostname.split('.');
        // Grab the top-level and 2nd-level dommains
        // docs.google.com -> google.com
        // www.standard.co.uk -> standard.co.uk
        const len = hostParts.length;
        let domain = ['co', 'com', 'ne', 'net', 'go'].includes(hostParts[len-2])
            ? hostParts.slice(len-3)
            : hostParts.slice(len-2);
        return trustedDomains.has(domain.join('.'));
    } catch (err) {
        return false;
    }
}
